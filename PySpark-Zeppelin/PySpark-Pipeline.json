{"paragraphs":[{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\nimport pyspark.sql.functions as F\n\nspark = SparkSession.builder.getOrCreate()","user":"anonymous","dateUpdated":"2022-06-30T14:39:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1656599503557_1556121323","id":"20220630-143143_1223534583","dateCreated":"2022-06-30T14:31:43+0000","dateStarted":"2022-06-30T14:39:26+0000","dateFinished":"2022-06-30T14:39:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:258"},{"text":"%pyspark\n# Extract\ndf = spark.read.format('csv').option('header', 'true').load('data/stocks_price_final.csv')\ndf.show()","user":"anonymous","dateUpdated":"2022-06-30T14:49:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656599685690_-362929243","id":"20220630-143445_1525871075","dateCreated":"2022-06-30T14:34:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:259","dateFinished":"2022-06-30T14:39:47+0000","dateStarted":"2022-06-30T14:39:45+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+----------+---------+---------+---------+---------+-------+---------+----------+-------------+--------------------+--------+\n|_c0|symbol|      date|     open|     high|      low|    close| volume| adjusted|market.cap|       sector|            industry|exchange|\n+---+------+----------+---------+---------+---------+---------+-------+---------+----------+-------------+--------------------+--------+\n|  1|   TXG|2019-09-12|       54|       58|       51|    52.75|7326300|    52.75|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  2|   TXG|2019-09-13|    52.75|   54.355|49.150002|    52.27|1025200|    52.27|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  3|   TXG|2019-09-16|52.450001|       56|52.009998|55.200001| 269900|55.200001|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  4|   TXG|2019-09-17|56.209999|60.900002|   55.423|56.779999| 602800|56.779999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  5|   TXG|2019-09-18|56.849998|    62.27|55.650002|       62|1589600|       62|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  6|   TXG|2019-09-19|62.810001|   63.375|61.029999|61.119999| 425200|61.119999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  7|   TXG|2019-09-20|61.709999|62.419998|    59.82|     60.5| 392000|     60.5|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  8|   TXG|2019-09-23|60.220001|61.485001|59.939999|60.330002| 137200|60.330002|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n|  9|   TXG|2019-09-24|       61|       61|       54|54.299999| 713800|54.299999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 10|   TXG|2019-09-25|54.459999|55.880001|   52.563|52.759998| 261200|52.759998|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 11|   TXG|2019-09-26|52.779999|53.689999|46.619999|49.990002| 596300|49.990002|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 12|   TXG|2019-09-27|51.130001|       55|50.700001|51.029999| 621300|51.029999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 13|   TXG|2019-09-30|51.049999|       52|    49.25|50.400002| 168900|50.400002|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 14|   TXG|2019-10-01|50.509998|51.919998|       46|47.029999| 536300|47.029999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 15|   TXG|2019-10-02|46.779999|    47.23|45.110001|    46.07| 519600|    46.07|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 16|   TXG|2019-10-03|    46.77|48.240002|    45.75|48.119999| 703900|48.119999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 17|   TXG|2019-10-04|       48|    53.34|    47.82|51.450001| 322400|51.450001|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 18|   TXG|2019-10-07|52.099998|53.220001|49.029999|50.360001| 476600|50.360001|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 19|   TXG|2019-10-08|       50|    51.27|       49|49.549999| 284100|49.549999|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n| 20|   TXG|2019-10-09|49.630001|51.525002|49.575001|50.009998| 201100|50.009998|    $9.31B|Capital Goods|Biotechnology: La...|  NASDAQ|\n+---+------+----------+---------+---------+---------+---------+-------+---------+----------+-------------+--------------------+--------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0","http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Transform\noutput = (df.withColumnRenamed('market.cap', 'cap').groupBy('sector').agg(F.count('sector').alias('count'),\n                                F.round(F.avg('volume')).alias('average'),\n                                F.min(\"cap\").alias('min'),\n                                F.max(\"cap\").alias('max')))\noutput.show(10)","user":"anonymous","dateUpdated":"2022-06-30T14:53:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656599985520_-1177608284","id":"20220630-143945_1806248065","dateCreated":"2022-06-30T14:39:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:492","dateFinished":"2022-06-30T14:53:32+0000","dateStarted":"2022-06-30T14:53:27+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------+---------+------+--------+\n|              sector| count|  average|   min|     max|\n+--------------------+------+---------+------+--------+\n|       Miscellaneous| 50221|1525584.0|$1.05B|$971.88M|\n|         Health Care|316175|1040784.0|$1.01B|     $9B|\n|    Public Utilities| 72836|1771911.0|$1.04B|$914.44M|\n|              Energy| 87494|3035825.0|$1.01B| $99.44B|\n|Consumer Non-Dura...| 78080|1481078.0|$1.01B|$987.34M|\n|             Finance|303180| 862056.0|$1.01B| $994.2M|\n|    Basic Industries| 97323|1656068.0|$1.01B|$989.87M|\n|       Capital Goods|133122|1209468.0|$1.03B| $987.6M|\n|          Technology|229799|1659185.0|$1.01B|$995.89M|\n|   Consumer Services|272393|1547602.0|$1.01B|     $9B|\n+--------------------+------+---------+------+--------+\nonly showing top 10 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=12","http://172.17.0.2:4040/jobs/job?id=13","http://172.17.0.2:4040/jobs/job?id=14","http://172.17.0.2:4040/jobs/job?id=15","http://172.17.0.2:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Load into node  partitions\noutput.write.mode('overwrite').format('json').save('data/results.json')","user":"anonymous","dateUpdated":"2022-06-30T15:02:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656600407479_-184523012","id":"20220630-144647_401550142","dateCreated":"2022-06-30T14:46:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:616","dateFinished":"2022-06-30T14:54:47+0000","dateStarted":"2022-06-30T14:54:40+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n# Load into n partitions\noutput.coalesce(4).write.mode('overwrite').format('json').save('data/results_4')","user":"anonymous","dateUpdated":"2022-06-30T14:58:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656600986123_-441083808","id":"20220630-145626_300910680","dateCreated":"2022-06-30T14:56:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1153","dateFinished":"2022-06-30T14:58:33+0000","dateStarted":"2022-06-30T14:58:28+0000","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ntest = spark.read.format('json').load('data/results_4/part-00003-a14b902a-7d0f-4fe1-82ae-7194c322f535-c000.json')\ntest.show()","user":"anonymous","dateUpdated":"2022-06-30T15:01:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656601085814_1695394970","id":"20220630-145805_1556091027","dateCreated":"2022-06-30T14:58:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1266","dateFinished":"2022-06-30T15:01:01+0000","dateStarted":"2022-06-30T15:01:01+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----+-------+------+-----------------+\n|  average|count|    max|   min|           sector|\n+---------+-----+-------+------+-----------------+\n| 894182.0|48404| $99.1M|$1.03B|Consumer Durables|\n|1741726.0|40007|$98.07M|$1.03B|   Transportation|\n+---------+-----+-------+------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=24","http://172.17.0.2:4040/jobs/job?id=25"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2022-06-30T15:01:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1656601261211_375408641","id":"20220630-150101_152371569","dateCreated":"2022-06-30T15:01:01+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1484"}],"name":"PySpark-Pipeline","id":"2H7KE2K6Y","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}